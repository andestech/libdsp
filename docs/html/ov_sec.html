<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Andes DSP Library: Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="andes_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Andes DSP Library
   &#160;<span id="projectnumber">V2.4</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ov_sec.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Andes DSP library V5 user manual contains information about DSP function specifications in Andes DSP library for ISA V5 toolchains and describes how to use these functions.</p>
<p>Andes DSP library provides comprehensive functions to easily and quickly develop digital signal processing systems with high code efficiency and streamlined code size. These functions include basic operations for vectors, matrices and complex vectors and functions which compute more complicated algorithms such as filtering and transform functions. Designed and developed with toolchains from Andes BSP v5.0 and later versions, Andes DSP library provides easy-to-use APIs to encapsulate the complexity of calculations when processing signals. It benefits you to save development resources, focus on your system and reduce development time.</p>
<p>The functions in Andes DSP library can be classified into several categories: basic functions, complex functions, controller functions, filtering functions, matrix functions, statistics functions, transform function and utility functions.</p>
<p>To call the library functions, just include header files provided by Andes DSP library. These header files define prototypes and instance structures of functions. They are named according to function categories as listed below:</p><ul>
<li>riscv_dsp_basic_math.h</li>
<li>riscv_dsp_complex_math.h</li>
<li>riscv_dsp_controller_math.h</li>
<li>riscv_dsp_filtering_math.h</li>
<li>riscv_dsp_matrix_math.h</li>
<li>riscv_dsp_statistics_math.h</li>
<li>riscv_dsp_transform_math.h</li>
<li>riscv_dsp_utils_math.h</li>
<li>riscv_dsp_distance_math.h</li>
<li>riscv_dsp_svm_math.h</li>
<li>riscv_dsp_sort_math.h</li>
</ul>
<p>For example, if you would like to use basic functions for some operations with vectors, you can include riscv_dsp_basic_math.h in your C files.</p>
<p><b>Note:</b> Note that controller functions are implemented directly in the header file riscv_dsp_controller_math.h for better performance. If you need to optimize them with the DSP ISA Extension, be sure to apply the compiler flag "-mext-dsp" to enable the toolchain support.</p>
<p>Andes DSP library defines several data types to properly store signal data for later processing. These data types, defined in riscv_dsp_math_types.h, are as follows:</p><ul>
<li>typedef int8_t q7_t; // Q7 type</li>
<li>typedef uint8_t u8_t; // U8 type</li>
<li>typedef int16_t q15_t; // Q15 type</li>
<li>typedef uint16_t q15_t; // U16 type</li>
<li>typedef int32_t q31_t; // Q31 type</li>
<li>typedef uint32_t q31_t; // U32 type</li>
<li>typedef int64_t q63_t; // Q63 type</li>
<li>typedef uint64_t q63_t; // U64 type</li>
<li>typedef float float32_t; // single-precision floating-point (F32) type</li>
<li>typedef double float64_t; // double-precision floating-point (F64) type</li>
<li>typedef _Float16 float16_t; // half-precision floating-point (F16) type</li>
</ul>
<p>Note:</p>
<p>If your application will use functions involving the half-precision floating-point data type, make sure to compile it with the option “-mzfh” using a toolchain with the HW FPU support (i.e., v5f or v5d toolchain). Please also be aware that this application can only be executed on a target with the HW FPU support; otherwise, problems will occur when the program is loaded.</p>
<h1><a class="anchor" id="ov_sec1"></a>
Linking Options for Newlib and MCUlib Toolchains</h1>
<p>In addition to the above header files, different linking options are required depending on the toolchain in use. This section introduces the options for Newlib and MCUlib toolchains, which include </p><div class="image">
<img src="mculink.png" alt=""/>
</div>
 <p>If your target system does not support the DSP ISA Extension to accelerate the DSP library, use the option -ldsp to build an application that links against Andes DSP library (libdsp.a); if the DSP ISA extension is available in your system, use the options -ldsp -mext-dsp to enable the extension and achieve better performance. Please be aware that an application built with -ldsp -mext-dsp can’t be executed on a target without the DSP ISA Extension support; otherwise, it will cause problems when loaded.</p>
<p>Note that when using a target with Andes 45-series core(s), the option -mtune=andes-45-series is available for you to enable the optimizations specialized for the series cores. In addition, if your applications will use Andes DSP library functions that involve the half-precision data type (e.g., riscv_dsp_log_f16), please make sure to use a toolchain with the HW FPU support (i.e., v5f or v5d toolchain) and apply the option “-mzfh” both in compiler and linker flags. The option “-mzfh” in compiler flags supports the half-precision floating-point data type “_Float16” used in DSP library. Without this option, problems will occur during program compilation. Please also be aware that an application built with -mzfh can’t be executed on a target without the HW FPU support; otherwise, it will cause problems when loaded.</p>
<p>Moreover, to use the following Andes DSP library functions that involve math functions from the libm library, be sure to apply the option -lm.</p><ul>
<li>riscv_dsp_std_f32</li>
<li>riscv_dsp_rms_f32</li>
<li>riscv_dsp_cmag_f32</li>
<li>riscv_dsp_sqrt_f32</li>
<li>riscv_dsp_atan_f32</li>
<li>riscv_dsp_absmax_f32</li>
<li>riscv_dsp_absmin_f32</li>
<li>riscv_dsp_lse_f32</li>
<li>riscv_dsp_lse_dprod_f32</li>
<li>riscv_dsp_entropy_f32</li>
<li>riscv_dsp_svm_rbf_est_f32</li>
<li>riscv_dsp_relative_entropy_f32</li>
<li>riscv_dsp_gaussian_naive_bayes_est_f32</li>
</ul>
<h1><a class="anchor" id="ov_sec2"></a>
Linking Options for Glibc Toolchains</h1>
<p>For glibc toolchains, the available linking options include </p><div class="image">
<img src="gliblink.png" alt=""/>
</div>
 <p>Static linking and dynamic linking require different options. The following table summarizes the required linking options according to the linking type and whether or not the application needs the DSP ISA Extension support. </p><div class="image">
<img src="gliblink2.png" alt=""/>
</div>
 <p>Among the required options, those with the DSP ISA Extension (i.e., -static -ldsp_p and -ldsp_p) are used to build applications for target systems supporting the extension whereas the others (i.e., -static -ldsp and -ldsp) are used only for targets not supporting the extension. Please make sure you specify the options corresponding to your target system. If your targets are Andes 45-series cores, you can enable the optimizations for Andes 45-series cores with the options -mtune=andes-45-series.</p>
<p>Note that when using a target with Andes 45-series core(s), the option -mtune=andes-45-series is available for you to enable the optimizations specialized for the series cores. In addition, if your applications will use Andes DSP library functions that involve the half-precision data type (e.g., riscv_dsp_log_f16), please make sure to use a toolchain with the HW FPU support (i.e., v5f or v5d toolchain) and apply the option “-mzfh” both in compiler and linker flags. The option “-mzfh” in compiler flags supports the half-precision floating-point data type “_Float16” used in DSP library. Without this option, problems will occur during program compilation. Please also be aware that an application built with -mzfh can’t be executed on a target without the HW FPU support; otherwise, it will cause problems when loaded.</p>
<p>Moreover, If your application to use the followingneeds Andes DSP library functions that involve math functions from the libm library, be sure to apply the option -lm.</p><ul>
<li>riscv_dsp_std_f32</li>
<li>riscv_dsp_rms_f32</li>
<li>riscv_dsp_cmag_f32</li>
<li>riscv_dsp_sqrt_f32</li>
<li>riscv_dsp_atan_f32</li>
<li>riscv_dsp_absmax_f32</li>
<li>riscv_dsp_absmin_f32</li>
<li>riscv_dsp_lse_f32</li>
<li>riscv_dsp_lse_dprod_f32</li>
<li>riscv_dsp_entropy_f32</li>
<li>riscv_dsp_svm_rbf_est_f32</li>
<li>riscv_dsp_relative_entropy_f32</li>
<li>riscv_dsp_gaussian_naive_bayes_est_f32</li>
</ul>
<h1><a class="anchor" id="ov_sec3"></a>
Data Alignment for Andes DSP Library Functions</h1>
<p>Andes DSP library V5 functions are designed for 32-bit Andes V5 CPU cores to use 4-byte aligned data and for 64-bit Andes V5 CPU cores to use 8-byte aligned data. That is, they assume the base memory addresses of input arrays, including input source arrays and output destination arrays, are aligned to 4-byte or 8-byte boundaries. These functions are implemented to load/store one word regardless of the type of input pointer, then process with SIMD DSP instructions to deliver high performance. Accessing a word from a misaligned memory location is called a misaligned memory access, which causes an Address Misaligned exception on a CPU that does not allow misaligned accesses. For a CPU that supports misaligned accesses and has the feature enabled, a misaligned memory access doesn’t result in an exception but a slight performance degradation. You may refer to AndeStar™ V5 Architecture and CSR Definitions for detailed descriptions of how Andes V5 CPUs handle misaligned accesses.</p>
<p>Among the data types supported by Andes DSP library V5 functions, Q31 and F32 are 4-byte data types and thus naturally aligned at 4-byte addresses when they are declared; Q15 and Q7 are 2-byte and 1-byte data types, which are aligned at 2-byte and 1-byte addresses by default respectively. To avoid misaligned memory accesses on 32-bit Andes V5 CPU cores, you need to explicitly declare that input arrays are accessed at 4-byte aligned addresses for Q15 and Q7. For examples, </p><pre>
     q7_t inputA[blocksize] __attribute__ ((aligned(4)));
     q15_t outputvec[blocksize] __attribute__ ((aligned(4)));
     </pre><p> On the other hand, to avoid misaligned memory accesses on 64-bit Andes V5 CPU cores, you need to declare explicitly the 8-byte alignment for all the four data types (i.e., Q31, Q15, Q7, and F32). For examples, </p><pre>
     q7_t inputA[blocksize] __attribute__ ((aligned(8)));
     q15_t outputvec[blocksize] __attribute__ ((aligned(8)));
     q31_t source[blocksize] __attribute__ ((aligned(8)));
     float32_t source[blocksize] __attribute__ ((aligned(8)));
     </pre><p> The following are functions that do not require explicit declaration of aligned accesses on 32-bit or 64-bit Andes V5 CPU cores:</p><ul>
<li>Controller functions</li>
<li>Conversion functions</li>
<li>Arc tangent functions</li>
<li>Arc tangent 2 functions</li>
<li>Cosine functions</li>
<li>Sine functions</li>
<li>Square root functions</li>
</ul>
<p>For 32-bit Andes V5 CPU cores only, the following functions do not require explicit declaration of aligned accesses either:</p><ul>
<li>Functions using input arrays of F32 data type</li>
<li>Functions using input arrays of Q31 data type </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
